set.seed(123)

facts <- list(1, 2:5)
units <- list(6, 5)
levels <- 3
etas <- list(1)
criteria <- "D"
model <- 'quadratic'

msopt <- MSOpt(facts, units, levels, etas, criteria, model)

sol <- matrix(c(1,-1, 1,-1,-1,
                1, 1, 1, 1,-1,
                1,-1,-1, 1, 1,
                1, 1,-1,-1,-1,
                1, 1, 1,-1, 1,
                -1, 0, 0, 1, 1,
                -1, 1,-1, 0, 1,
                -1,-1,-1,-1,-1,
                -1, 0, 1,-1, 0,
                -1, 1, 0,-1, 1,
                0,-1, 1, 0, 1,
                0, 0,-1, 0,-1,
                0,-1, 0,-1,-1,
                0, 1, 1, 1, 0,
                0,-1, 1, 1,-1,
                -1, 1, 1, 1, 1,
                -1,-1, 0, 0, 0,
                -1, 0,-1,-1, 1,
                -1, 1, 1,-1,-1,
                -1, 1,-1, 1,-1,
                -1,-1, 1,-1, 1,
                -1,-1,-1, 1, 1,
                -1, 0, 0, 0,-1,
                -1, 1,-1,-1, 0,
                -1,-1, 1, 1,-1,
                1, 1, 1,-1,-1,
                1,-1,-1, 1,-1,
                1,-1,-1,-1, 1,
                1, 1,-1, 1, 1,
                1,-1, 1, 1, 1), byrow = T, ncol = 5)

test_that("MSSearch works", {
  expect_equal(MSSearch(msopt, 1, "Restarts", 100),
               list("optsol" = sol,
                    "optsc" = 0.0935,
                    "feval" = 134861,
                    "trend" = c(rep(0.0951, 4), rep(0.0939, 26), rep(0.0935, 70))
               )
  )
  }
)




